{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:chatbot_chatbotconfiguration_changelist' %}">{% trans 'Chatbot configurations' %}</a>
&rsaquo; {% trans 'Training Statistics' %}
</div>
{% endblock %}

{% block content %}
<h1>{{ title }}</h1>

<div class="module aligned">
    <h2>Current Training Data</h2>
    {% if stats %}
        <table class="table">
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Total Sessions</strong></td>
                    <td>{{ stats.total_sessions }}</td>
                </tr>
                <tr>
                    <td><strong>Total Messages</strong></td>
                    <td>{{ stats.total_messages }}</td>
                </tr>
                <tr>
                    <td><strong>Recent Conversations (7 days)</strong></td>
                    <td>{{ stats.recent_conversations }}</td>
                </tr>
                <tr>
                    <td><strong>Average Response Quality</strong></td>
                    <td>{{ stats.average_response_quality|floatformat:3|default:"N/A" }}</td>
                </tr>
                <tr>
                    <td><strong>Training Data Files</strong></td>
                    <td>{{ stats.training_data_files }}</td>
                </tr>
                <tr>
                    <td><strong>Available Models</strong></td>
                    <td>{{ stats.available_models }}</td>
                </tr>
            </tbody>
        </table>
    {% else %}
        <p>No training statistics available.</p>
    {% endif %}
</div>

<div class="module aligned">
    <h2>Actions</h2>
    <div class="submit-row">
        <a href="{% url 'admin:chatbot_train_ai' %}" class="button default">Train AI Model</a>
        <a href="{% url 'admin:chatbot_chatbotconfiguration_changelist' %}" class="button cancel-link">Back to Chatbot Configurations</a>
    </div>
</div>

{% if stats and stats.total_sessions > 0 %}
<div class="module aligned">
    <h2>Training Recommendations</h2>
    <div class="form-row">
        {% if stats.total_sessions < 10 %}
            <div class="alert alert-info">
                <p><strong>Low Data Volume:</strong> You have {{ stats.total_sessions }} sessions. Consider waiting for more data before training for better results.</p>
            </div>
        {% elif stats.average_response_quality < 0.5 %}
            <div class="alert alert-warning">
                <p><strong>Low Quality Score:</strong> Current average quality is {{ stats.average_response_quality|floatformat:3 }}. Training might help improve responses.</p>
            </div>
        {% else %}
            <div class="alert alert-success">
                <p><strong>Good Training Data:</strong> You have sufficient data ({{ stats.total_sessions }} sessions) with decent quality scores for training.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endif %}

{% endblock %}
