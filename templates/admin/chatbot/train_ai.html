{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:chatbot_chatbotconfiguration_changelist' %}">{% trans 'Chatbot configurations' %}</a>
&rsaquo; {% trans 'Train AI' %}
</div>
{% endblock %}

{% block content %}
<h1>{{ title }}</h1>

<div class="module aligned">
    <h2>Training Statistics</h2>
    {% if stats %}
        <table>
            <tr>
                <th>Total Sessions</th>
                <td>{{ stats.total_sessions }}</td>
            </tr>
            <tr>
                <th>Total Messages</th>
                <td>{{ stats.total_messages }}</td>
            </tr>
            <tr>
                <th>Recent Conversations (7 days)</th>
                <td>{{ stats.recent_conversations }}</td>
            </tr>
            <tr>
                <th>Average Response Quality</th>
                <td>{{ stats.average_response_quality|floatformat:3 }}</td>
            </tr>
            <tr>
                <th>Training Data Files</th>
                <td>{{ stats.training_data_files }}</td>
            </tr>
            <tr>
                <th>Available Models</th>
                <td>{{ stats.available_models }}</td>
            </tr>
        </table>
    {% else %}
        <p>No training data available yet.</p>
    {% endif %}
</div>

<div class="module aligned">
    <h2>Start Training</h2>
    <form method="post">
        {% csrf_token %}
        <p>This will train the AI model using the last 30 days of conversation data.</p>
        <p><strong>Note:</strong> Training may take several minutes depending on the amount of data.</p>
        
        <div class="submit-row">
            <input type="submit" value="Start Training" class="default" />
            <a href="{% url 'admin:chatbot_chatbotconfiguration_changelist' %}" class="button cancel-link">Cancel</a>
        </div>
    </form>
</div>

{% if stats.total_sessions == 0 %}
<div class="module aligned">
    <div class="alert alert-warning">
        <h3>No Training Data Available</h3>
        <p>You need to have conversations with the chatbot before you can train the AI model. Start using the chatbot to generate training data!</p>
    </div>
</div>
{% endif %}

{% endblock %}
