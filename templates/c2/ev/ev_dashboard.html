{% extends "base.html" %}
{% block content %}

<style>
  /* Modern CSS Reset and Base Styles */
  * {
    box-sizing: border-box;
  }

  body {
    background: transparent;
    min-height: 100vh;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
    color: #2d3748;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }

  /* Modern Color Palette - Professional & Accessible */
  :root {
    /* Primary Colors */
    --primary: #4f46e5;
    --primary-50: #eef2ff;
    --primary-100: #e0e7ff;
    --primary-200: #c7d2fe;
    --primary-300: #a5b4fc;
    --primary-400: #818cf8;
    --primary-500: #6366f1;
    --primary-600: #4f46e5;
    --primary-700: #4338ca;
    --primary-800: #3730a3;
    --primary-900: #312e81;

    /* Secondary Colors */
    --secondary: #7c3aed;
    --secondary-50: #f5f3ff;
    --secondary-100: #ede9fe;
    --secondary-200: #ddd6fe;
    --secondary-300: #c4b5fd;
    --secondary-400: #a78bfa;
    --secondary-500: #8b5cf6;
    --secondary-600: #7c3aed;
    --secondary-700: #6d28d9;
    --secondary-800: #5b21b6;
    --secondary-900: #4c1d95;

    /* Status Colors */
    --success: #10b981;
    --success-50: #ecfdf5;
    --success-100: #d1fae5;
    --success-200: #a7f3d0;
    --success-300: #6ee7b7;
    --success-400: #34d399;
    --success-500: #10b981;
    --success-600: #059669;
    --success-700: #047857;
    --success-800: #065f46;
    --success-900: #064e3b;

    --warning: #f59e0b;
    --warning-50: #fffbeb;
    --warning-100: #fef3c7;
    --warning-200: #fde68a;
    --warning-300: #fcd34d;
    --warning-400: #fbbf24;
    --warning-500: #f59e0b;
    --warning-600: #d97706;
    --warning-700: #b45309;
    --warning-800: #92400e;
    --warning-900: #78350f;

    --danger: #ef4444;
    --danger-50: #fef2f2;
    --danger-100: #fee2e2;
    --danger-200: #fecaca;
    --danger-300: #fca5a5;
    --danger-400: #f87171;
    --danger-500: #ef4444;
    --danger-600: #dc2626;
    --danger-700: #b91c1c;
    --danger-800: #991b1b;
    --danger-900: #7f1d1d;

    --info: #06b6d4;
    --info-50: #ecfeff;
    --info-100: #cffafe;
    --info-200: #a5f3fc;
    --info-300: #67e8f9;
    --info-400: #22d3ee;
    --info-500: #06b6d4;
    --info-600: #0891b2;
    --info-700: #0e7490;
    --info-800: #155e75;
    --info-900: #164e63;

    /* Neutral Colors */
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --gray-900: #111827;

    /* Semantic Colors */
    --white: #ffffff;
    --black: #000000;
    --text-primary: var(--gray-900);
    --text-secondary: var(--gray-600);
    --text-muted: var(--gray-500);
    --border-color: var(--gray-200);
    --bg-primary: var(--white);
    --bg-secondary: var(--gray-50);
    --bg-tertiary: var(--gray-100);

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);

    /* Border Radius */
    --radius-sm: 0.375rem;
    --radius: 0.5rem;
    --radius-md: 0.75rem;
    --radius-lg: 1rem;
    --radius-xl: 1.5rem;
    --radius-2xl: 2rem;

    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-8: 2rem;
    --space-10: 2.5rem;
    --space-12: 3rem;
    --space-16: 4rem;
    --space-20: 5rem;

    /* Transitions */
    --transition-fast: 150ms ease-in-out;
    --transition-normal: 300ms ease-in-out;
    --transition-slow: 500ms ease-in-out;
  }

  /* Enhanced Animations */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateX(30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes slideInDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pulse {
    0%, 100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
  }

  @keyframes shimmer {
    0% {
      background-position: -200px 0;
    }
    100% {
      background-position: calc(200px + 100%) 0;
    }
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  @keyframes glow {
    0%, 100% {
      box-shadow: 0 0 5px rgba(79, 70, 229, 0.3);
    }
    50% {
      box-shadow: 0 0 20px rgba(79, 70, 229, 0.6);
    }
  }

  /* Dashboard Layout */
  .dashboard-container {
    min-height: 100vh;
    padding: var(--space-6);
    animation: fadeInUp 0.8s ease-out;
    position: relative;
    max-width: 1400px;
    margin: 0 auto;
  }

  /* Glass Morphism Effect */
  .glass-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-xl);
    transition: all var(--transition-normal);
  }

  .glass-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-2xl);
  }

  /* Dashboard Header */
  .dashboard-header {
    margin-bottom: var(--space-8);
    padding: var(--space-6);
    background: var(--glass-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    animation: slideInDown 0.6s ease-out;
    position: relative;
    overflow: hidden;
  }

  .dashboard-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--primary), var(--secondary), var(--info));
    background-size: 200% 100%;
    animation: shimmer 3s ease-in-out infinite;
  }

  .dashboard-header h2 {
    color: var(--gray-800);
    font-weight: 700;
    font-size: 2.5rem;
    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--space-4);
  }

  .dashboard-header h2 i {
    font-size: 2.8rem;
    color: var(--primary-600);
    animation: float 3s ease-in-out infinite;
  }

  /* Enhanced Card Styles */
  .metric-card {
    background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
    border: none;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    transition: all var(--transition-normal);
    overflow: hidden;
    animation: scaleIn 0.6s ease-out;
    position: relative;
    color: var(--white);
  }

  .metric-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, rgba(255,255,255,0.6), rgba(255,255,255,0.2));
  }

  .metric-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: var(--shadow-2xl);
    animation: glow 2s ease-in-out infinite;
  }

  .metric-card.bg-primary {
    background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
  }

  .metric-card.bg-success {
    background: linear-gradient(135deg, var(--success-600), var(--success-800));
  }

  .metric-card.bg-danger {
    background: linear-gradient(135deg, var(--danger-600), var(--danger-800));
  }

  .metric-card .card-header {
    border-bottom: 1px solid rgba(255,255,255,0.2);
    font-weight: 600;
    letter-spacing: 0.5px;
    padding: var(--space-4);
    font-size: 1.1rem;
    color: rgba(255,255,255,0.9);
  }

  .metric-card .card-title {
    font-size: 3rem;
    font-weight: 700;
    margin: var(--space-4) 0;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    color: var(--white);
  }

  /* Form Entry Cards */
  .entry-card {
    background: var(--glass-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    transition: all var(--transition-normal);
    border-left: 4px solid var(--info);
    height: 100%;
    position: relative;
    overflow: hidden;
    animation: fadeInLeft 0.6s ease-out;
  }

  .entry-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, var(--info), var(--info-400));
  }

  .entry-card:hover {
    transform: translateY(-6px) scale(1.02);
    box-shadow: var(--shadow-2xl);
  }

  .entry-card .card-body {
    padding: var(--space-6);
  }

  .entry-card .card-title {
    color: var(--gray-700);
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
    font-weight: 600;
  }

  .entry-card .card-text {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--primary-700);
    margin: 0;
    text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  }

  /* Search Bar */
  .search-container {
    position: relative;
    margin: var(--space-8) 0;
    background: var(--glass-card);
    padding: var(--space-4);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    animation: fadeInUp 0.6s ease-out;
  }

  .search-container .form-control {
    border-radius: var(--radius-lg);
    padding: var(--space-4) var(--space-5);
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-sm);
    font-size: 1rem;
    transition: all var(--transition-normal);
  }

  .search-container .form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
  }

  .search-container .btn {
    position: absolute;
    right: var(--space-2);
    top: var(--space-2);
    border-radius: var(--radius-lg);
    padding: var(--space-3) var(--space-5);
    background: linear-gradient(to right, var(--primary), var(--secondary));
    border: none;
    transition: all var(--transition-normal);
    font-weight: 600;
  }

  .search-container .btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  /* Facilities Table */
  .facilities-card {
    border: none;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
    background: var(--glass-card);
    animation: fadeInRight 0.6s ease-out;
  }

  .facilities-card .card-header {
    background: linear-gradient(135deg, var(--success), var(--success-400));
    color: var(--white);
    font-weight: 600;
    letter-spacing: 0.5px;
    font-size: 1.2rem;
    padding: var(--space-5);
  }

  .table {
    margin-bottom: 0;
  }

  .table thead th {
    background: linear-gradient(to right, var(--gray-100), var(--white));
    font-weight: 600;
    border-bottom: 2px solid var(--gray-300);
    padding: var(--space-4);
    color: var(--gray-800);
  }

  .table tbody td {
    padding: var(--space-4);
    vertical-align: middle;
    border-bottom: 1px solid var(--gray-200);
  }

  .table tbody tr {
    transition: all var(--transition-normal);
  }

  .table tbody tr:hover {
    background: linear-gradient(to right, rgba(79, 70, 229, 0.05), rgba(124, 58, 237, 0.05));
    transform: translateX(3px);
  }

    /* Pagination */
    .pagination .page-item .page-link {
        border: none;
        color: var(--primary);
        margin: 0 3px;
        border-radius: 8px !important;
    }

    .pagination .page-item.active .page-link {
        background: linear-gradient(to right, var(--primary), var(--secondary));
        color: white;
        box-shadow: 0 4px 8px rgba(67, 97, 238, 0.2);
    }

  /* Mobile Responsive Design */
  @media (max-width: 1200px) {
    .dashboard-container {
      padding: var(--space-4);
    }
  }

  @media (max-width: 768px) {
    .dashboard-container {
      padding: var(--space-3);
    }

    .dashboard-header {
      padding: var(--space-4);
      margin-bottom: var(--space-6);
    }

    .dashboard-header h2 {
      font-size: 2rem;
      flex-direction: column;
      text-align: center;
      gap: var(--space-2);
    }

    .dashboard-header h2 i {
      font-size: 2.2rem;
    }

    .metric-card .card-title {
      font-size: 2.2rem;
    }

    .entry-card .card-text {
      font-size: 2rem;
    }

    .entry-card .card-body {
      padding: var(--space-4);
    }

    .search-container {
      margin: var(--space-4) 0;
      padding: var(--space-3);
    }

    .search-container .form-control {
      padding: var(--space-3) var(--space-4);
      font-size: 0.95rem;
    }

    .search-container .btn {
      padding: var(--space-2) var(--space-4);
      font-size: 0.9rem;
    }

    .table {
      font-size: 0.9rem;
    }

    .table thead th {
      padding: var(--space-3);
    }

    .table tbody td {
      padding: var(--space-3);
    }

    .facilities-card .card-header {
      font-size: 1rem;
      padding: var(--space-3);
    }
  }

  @media (max-width: 480px) {
    .dashboard-container {
      padding: var(--space-2);
    }

    .dashboard-header h2 {
      font-size: 1.8rem;
    }

    .dashboard-header h2 i {
      font-size: 2rem;
    }

    .metric-card .card-title {
      font-size: 2rem;
    }

    .entry-card .card-text {
      font-size: 1.8rem;
    }

    .entry-card .card-title {
      font-size: 1rem;
    }
  }

  /* Touch-friendly interactions for mobile */
  @media (hover: none) and (pointer: coarse) {
    .metric-card:hover,
    .entry-card:hover {
      transform: none;
    }

    .metric-card:active,
    .entry-card:active {
      transform: scale(0.98);
    }
  }

  /* Accessibility Improvements */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Focus states for keyboard navigation */
  .metric-card:focus,
  .entry-card:focus {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
  }

    @media (max-width: 576px) {
        .dashboard-container {
            padding: 0.75rem;
            margin-top: 0.75rem;
        }

        .metric-card {
            margin-bottom: 0.75rem;
        }

        .metric-card .card-title {
            font-size: 1.5rem;
        }

        .entry-card .card-text {
            font-size: 1.3rem;
        }

        .entry-card .card-title {
            font-size: 0.9rem;
        }

        .facilities-card .card-header {
            font-size: 0.95rem;
            padding: 0.6rem;
        }

        .table {
            font-size: 0.85rem;
        }

        .table thead th {
            padding: 0.5rem;
        }

        .table tbody td {
            padding: 0.5rem;
        }

        .pagination {
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.25rem;
        }

        .pagination .page-link {
            padding: 0.3rem 0.6rem;
            font-size: 0.85rem;
        }

        .search-container .form-control {
            padding: 8px 12px;
            font-size: 0.9rem;
        }

        .search-container .btn {
            padding: 5px 12px;
            font-size: 0.85rem;
        }
    }

    @media (max-width: 360px) {
        .dashboard-container {
            padding: 0.5rem;
            margin-top: 0.5rem;
        }

        .metric-card .card-title {
            font-size: 1.3rem;
        }

        .entry-card .card-text {
            font-size: 1.1rem;
        }

        .entry-card .card-title {
            font-size: 0.85rem;
        }

        .facilities-card .card-header {
            font-size: 0.9rem;
            padding: 0.5rem;
        }

        .table {
            font-size: 0.8rem;
        }

        .table thead th {
            padding: 0.4rem;
        }

        .table tbody td {
            padding: 0.4rem;
        }

        .pagination .page-link {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }

        .search-container .form-control {
            padding: 6px 10px;
            font-size: 0.85rem;
        }

        .search-container .btn {
            padding: 4px 10px;
            font-size: 0.8rem;
        }
    }

</style>

<div class="container-fluid dashboard-container">
    <div class="dashboard-header">
       <h2>
          <i class="fas fa-chart-line"></i>
         Evaluator Dashboard
       </h2>
    </div>

    <!-- Metrics Row with Animated Counters -->
    <div class="row g-2">
        <div class="col-12 col-md-4">
            <div class="card text-white text-center bg-danger mb-2 metric-card" id="failed-sites-card">
                <div class="card-header">Failed Sites (Last 30 Days)</div>
                <div class="card-body">
                    <h4 class="card-title counter" data-target="{{ failed_sites_count }}">0</h4>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-4">
            <div class="card text-white text-center bg-primary mb-2 metric-card" id="total-facilities-card">
                <div class="card-header">Total Facilities</div>
                <div class="card-body">
                    <h4 class="card-title counter" data-target="{{ total_facilities }}">0</h4>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-4">
            <div class="card text-white text-center bg-success mb-2 metric-card" id="passed-facilities-card">
                <div class="card-header">Facilities Passed This Month</div>
                <div class="card-body">
                    <h4 class="card-title counter" data-target="{{ passed_facilities_count }}">0</h4>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Entry Counts -->
    <div class="row g-2 mt-3">
        <div class="col-12 col-md-4">
            <div class="card entry-card h-100" style="animation-delay: 0.1s;">
                <div class="card-body text-center">
                    <h5 class="card-title">🗓 Form Entries This Week</h5>
                    <h4 class="card-text counter" data-target="{{ weekly_count }}">0</h4>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-4">
            <div class="card entry-card h-100" style="animation-delay: 0.2s;">
                <div class="card-body text-center">
                    <h5 class="card-title">📆 Form Entries This Month</h5>
                    <h4 class="card-text counter" data-target="{{ monthly_count }}">0</h4>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-4">
            <div class="card entry-card h-100" style="animation-delay: 0.3s;">
                <div class="card-body text-center">
                    <h5 class="card-title">📅 Form Entries This Year</h5>
                    <h4 class="card-text counter" data-target="{{ yearly_count }}">0</h4>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Bar -->
    <form method="GET" class="search-container">
        <input type="text" name="search" class="form-control" placeholder="Search facility..." value="{{ search_query }}">
        <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
    </form>

    <!-- Facilities Table -->
    <div class="card facilities-card mt-4">
        <div class="card-header d-flex align-items-center">

            <span>🏆 Congratulations! Facilities Passed This Month</span>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>ID</th>
                            <th>Facility Name</th>
                            <th>Date Created</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for facility in page_obj %}
                        <tr>
                            <td>{{ facility.id }}</td>
                            <td>{{ facility.s_image__facility__name }}</td>
                            <td>{{ facility.created|date:"F d, Y" }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="3" class="text-center py-4">No passed facilities found.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <nav aria-label="Page navigation" class="px-3 pb-3">
                <ul class="pagination justify-content-center mt-3">
                    {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?search={{ search_query }}&page=1"><i class="fas fa-angle-double-left"></i></a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?search={{ search_query }}&page={{ page_obj.previous_page_number }}"><i class="fas fa-angle-left"></i></a>
                        </li>
                    {% endif %}

                    <li class="page-item active"><span class="page-link">{{ page_obj.number }}</span></li>

                    {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?search={{ search_query }}&page={{ page_obj.next_page_number }}"><i class="fas fa-angle-right"></i></a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?search={{ search_query }}&page={{ page_obj.paginator.num_pages }}"><i class="fas fa-angle-double-right"></i></a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Enhanced Animation Scripts -->
<script>
    // Enhanced Counter Animation with Intersection Observer
    document.addEventListener('DOMContentLoaded', function() {
        const counters = document.querySelectorAll('.counter');
        
        // Intersection Observer for better performance
        const observerOptions = {
            threshold: 0.5,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const counter = entry.target;
                    const target = parseInt(counter.getAttribute('data-target'));
                    animateCounter(counter, target);
                    observer.unobserve(counter);
                }
            });
        }, observerOptions);

        // Enhanced counter animation with easing
        function animateCounter(element, target) {
            const duration = 2000;
            const startTime = performance.now();
            const startValue = 0;
            
            function updateCounter(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function for smooth animation
                const easeOutCubic = 1 - Math.pow(1 - progress, 3);
                const currentValue = Math.floor(startValue + (target - startValue) * easeOutCubic);
                
                element.textContent = currentValue.toLocaleString();
                
                if (progress < 1) {
                    requestAnimationFrame(updateCounter);
                } else {
                    element.textContent = target.toLocaleString();
                }
            }
            
            requestAnimationFrame(updateCounter);
        }

        // Observe all counters
        counters.forEach(counter => {
            observer.observe(counter);
        });

        // Add loading states and error handling
        const cards = document.querySelectorAll('.metric-card, .entry-card');
        
        cards.forEach((card, index) => {
            // Staggered animation delays
            card.style.animationDelay = `${index * 0.1}s`;
        });

        // Add touch feedback for mobile
        if ('ontouchstart' in window) {
            cards.forEach(card => {
                card.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.98)';
                });
                
                card.addEventListener('touchend', function() {
                    this.style.transform = '';
                });
            });
        }

        // Hover counter animation for all cards
        function addHoverCounterAnimation() {
            const allCards = document.querySelectorAll('.metric-card, .entry-card');
            
            allCards.forEach(card => {
                const counter = card.querySelector('.counter');
                if (!counter) return;
                
                const targetValue = parseInt(counter.getAttribute('data-target'));
                if (isNaN(targetValue)) return;
                
                let isAnimating = false;
                let animationId = null;
                
                // Mouse enter event
                card.addEventListener('mouseenter', function() {
                    if (isAnimating) return;
                    
                    isAnimating = true;
                    let currentValue = 0;
                    const duration = 1000; // 1 second animation
                    const startTime = performance.now();
                    
                    function animateCounter(currentTime) {
                        const elapsed = currentTime - startTime;
                        const progress = Math.min(elapsed / duration, 1);
                        
                        // Easing function for smooth animation
                        const easeOutCubic = 1 - Math.pow(1 - progress, 3);
                        currentValue = Math.floor(targetValue * easeOutCubic);
                        
                        counter.textContent = currentValue.toLocaleString();
                        
                        if (progress < 1) {
                            animationId = requestAnimationFrame(animateCounter);
                        } else {
                            counter.textContent = targetValue.toLocaleString();
                            isAnimating = false;
                        }
                    }
                    
                    animationId = requestAnimationFrame(animateCounter);
                });
                
                // Mouse leave event - reset to target value
                card.addEventListener('mouseleave', function() {
                    if (animationId) {
                        cancelAnimationFrame(animationId);
                    }
                    isAnimating = false;
                    counter.textContent = targetValue.toLocaleString();
                });
            });
        }

        // Initialize hover counter animations
        addHoverCounterAnimation();
    });
</script>

{% endblock %}